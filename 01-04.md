# [**MITRE ATT&CK Enterprise FrameWork**](https://attack.mitre.org/)

> by HTTP 418 I'm a teapot. @NSFOCUS

***

<!-- TOC -->

- [**MITRE ATT&CK Enterprise FrameWork**](#mitre-attck-enterprise-framework)
  - [Perface](#perface)
  - [Initial Access (初始访问)](#initial-access-%e5%88%9d%e5%a7%8b%e8%ae%bf%e9%97%ae)
    - [Drive-by Compromise (过路式入侵)](#drive-by-compromise-%e8%bf%87%e8%b7%af%e5%bc%8f%e5%85%a5%e4%be%b5)
      - [缓解](#%e7%bc%93%e8%a7%a3)
      - [检测](#%e6%a3%80%e6%b5%8b)
    - [Exploit Public-Facing Application (利用大众化应用程序)](#exploit-public-facing-application-%e5%88%a9%e7%94%a8%e5%a4%a7%e4%bc%97%e5%8c%96%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f)
      - [缓解](#%e7%bc%93%e8%a7%a3-1)
      - [检测](#%e6%a3%80%e6%b5%8b-1)
    - [External Remote Services (外部远程服务)](#external-remote-services-%e5%a4%96%e9%83%a8%e8%bf%9c%e7%a8%8b%e6%9c%8d%e5%8a%a1)
      - [缓解](#%e7%bc%93%e8%a7%a3-2)
      - [检测](#%e6%a3%80%e6%b5%8b-2)
    - [Hardware Additions (物理渗透硬件)](#hardware-additions-%e7%89%a9%e7%90%86%e6%b8%97%e9%80%8f%e7%a1%ac%e4%bb%b6)
      - [缓解](#%e7%bc%93%e8%a7%a3-3)
      - [检测](#%e6%a3%80%e6%b5%8b-3)
    - [Replication Through Removable Media (通过可移动媒介复制)](#replication-through-removable-media-%e9%80%9a%e8%bf%87%e5%8f%af%e7%a7%bb%e5%8a%a8%e5%aa%92%e4%bb%8b%e5%a4%8d%e5%88%b6)
      - [缓解](#%e7%bc%93%e8%a7%a3-4)
      - [检测](#%e6%a3%80%e6%b5%8b-4)
    - [Spearphishing Attachment (鱼叉式钓鱼附件)](#spearphishing-attachment-%e9%b1%bc%e5%8f%89%e5%bc%8f%e9%92%93%e9%b1%bc%e9%99%84%e4%bb%b6)
      - [缓解](#%e7%bc%93%e8%a7%a3-5)
      - [检测](#%e6%a3%80%e6%b5%8b-5)
    - [Spearphishing Link (鱼叉式钓鱼链接)](#spearphishing-link-%e9%b1%bc%e5%8f%89%e5%bc%8f%e9%92%93%e9%b1%bc%e9%93%be%e6%8e%a5)
      - [缓解](#%e7%bc%93%e8%a7%a3-6)
      - [检测](#%e6%a3%80%e6%b5%8b-6)
    - [Spearphishing via Service (服务式鱼叉钓鱼)](#spearphishing-via-service-%e6%9c%8d%e5%8a%a1%e5%bc%8f%e9%b1%bc%e5%8f%89%e9%92%93%e9%b1%bc)
      - [缓解](#%e7%bc%93%e8%a7%a3-7)
      - [检测](#%e6%a3%80%e6%b5%8b-7)
    - [Supply Chain Compromise (供应链入侵)](#supply-chain-compromise-%e4%be%9b%e5%ba%94%e9%93%be%e5%85%a5%e4%be%b5)
      - [缓解](#%e7%bc%93%e8%a7%a3-8)
      - [检测](#%e6%a3%80%e6%b5%8b-8)
    - [Trusted Relationship (受信关系)](#trusted-relationship-%e5%8f%97%e4%bf%a1%e5%85%b3%e7%b3%bb)
      - [缓解](#%e7%bc%93%e8%a7%a3-9)
      - [检测](#%e6%a3%80%e6%b5%8b-9)
    - [Valid Accounts (合法账号)](#valid-accounts-%e5%90%88%e6%b3%95%e8%b4%a6%e5%8f%b7)
      - [缓解](#%e7%bc%93%e8%a7%a3-10)
      - [检测](#%e6%a3%80%e6%b5%8b-10)
  - [Execution (执行)](#execution-%e6%89%a7%e8%a1%8c)
    - [AppleScript (AppleScript)](#applescript-applescript)
      - [缓解](#%e7%bc%93%e8%a7%a3-11)
      - [检测](#%e6%a3%80%e6%b5%8b-11)
    - [CMSPT (CMSTP.exe)](#cmspt-cmstpexe)
      - [缓解](#%e7%bc%93%e8%a7%a3-12)
      - [检测](#%e6%a3%80%e6%b5%8b-12)
    - [Command-Line Interface (命令行界面)](#command-line-interface-%e5%91%bd%e4%bb%a4%e8%a1%8c%e7%95%8c%e9%9d%a2)
      - [缓解](#%e7%bc%93%e8%a7%a3-13)
      - [检测](#%e6%a3%80%e6%b5%8b-13)
    - [Compiled HTML File (.chm文件)](#compiled-html-file-chm%e6%96%87%e4%bb%b6)
      - [缓解](#%e7%bc%93%e8%a7%a3-14)
      - [检测](#%e6%a3%80%e6%b5%8b-14)
  - [Persistence (持久化)](#persistence-%e6%8c%81%e4%b9%85%e5%8c%96)
  - [Privilege Escalation (提权)](#privilege-escalation-%e6%8f%90%e6%9d%83)

<!-- /TOC -->

***

## Perface

基于**MITRE ATT&CK模型**整理的文档式中译版。

建议针对**关键词语**采用双语对照，可以参照[**Initial Access**](#initial-access-%e5%88%9d%e5%a7%8b%e8%ae%bf%e9%97%ae)。

***

## Initial Access (初始访问)

>[攻击者正试图进入您的网络](https://attack.mitre.org/tactics/TA0001/)

**初始访问** 包括使用 **各种入口向量** 在网络中获得其 **初始入侵点** 的技术。用于获取 **入侵点** 技术包括 **针对性的鱼叉攻击** 和 **公共Web服务器** 。通过 **初始访问** 获得的 **入侵点** 可能支持进一步侵入，例如 **有效的帐户群** 和 **远程服务的外部使用权** ，也可能由于密码的修改而失效。

***

### Drive-by Compromise (过路式入侵)

>[原文链接](https://attack.mitre.org/techniques/T1189/)

**过路式入侵** 是指攻击者通过用户在正常浏览过程中访问网站来获得对系统的访问权限。使用此技术，通常会将用户的Web浏览器作为攻击目标，但攻击者也可能会将受侵害的网站用于非利用行为，例如获取应用程序访问令牌。

存在多种将漏洞利用代码传递给浏览器的方法，包括：

- 恶意代码的注入
- 恶意广告的投放
- 内置的Web内容 (论坛帖子、评论等等)

对手使用的网站通常是特定社区(例如政府，特定行业或地区)访问的网站，其目标是基于共同利益来威胁特定用户或一组用户。这种有针对性的攻击被称为战略性网络入侵或水坑攻击。

- 用户访问了托管了攻击者受控内容的网站
- 脚本会自动执行，通常会搜索存在漏洞的浏览器或插件版本
  - 可能要求用户通过启用脚本或活动的网站组件并忽略警告对话框来协助此过程
- 一旦发现有漏洞的版本，攻击代码将会传到浏览器
- 如果利用成功，那么除非有其他保护措施，否则它将使对手代码在用户的系统上执行
  - 在某些情况下，在提供漏洞利用代码之前，需要在初始扫描后再次访问网站
  
#### 缓解

缓解|描述
:--:|:--
应用隔离与沙箱机制|浏览器沙箱可用于减轻某些利用的影响，其他类型的虚拟化和应用程序微分段也可以减轻客户端利用的影响
漏洞防护|查找漏洞利用过程中的行为的安全应用程序
限制基于Web的内容|对于通过广告投放的恶意代码，adblocker可以帮助阻止该代码首先执行。脚本阻止扩展可以帮助阻止可能在开发过程中普遍使用的JavaScript的执行。
更新软件|确保所有浏览器和插件保持更新

#### 检测

- 防火墙和代理可以检查URL中潜在的已知危险域或参数
- 网络入侵检测系统，有时配合SSL/TLS MITM检测，可以查找已知的恶意脚本
- 合法网站的 **过路式入侵** 检测会很困难，还要寻找终端所提供的成功入侵的证据

***

### Exploit Public-Facing Application (利用大众化应用程序)

>[原文链接](https://attack.mitre.org/techniques/T1189/)

使用软件，数据或命令来利用面向 Internet 的计算机系统或程序中的脆弱点，从而导致意外或无法预期的行为。

- 系统的弱点可能是bug，故障或设计漏洞
- 这些应用程序通常是网站，但是可以包括数据库(例如SQL)，标准服务(例如SMB或SSH)以及具有Internet可访问开放套接字的任何其他应用程序
- 如果应用程序托管在基于云的基础架构上，利用这一点可能会导致底层受到损害。这可以让攻击者获得访问云API或利用弱身份和访问管理策略

#### 缓解

缓解|描述
:--:|:--
应用隔离与沙箱机制|应用程序隔离将限制被利用的目标对其他进程和系统功能的访问
漏洞防护|WAF可用于限制应用程序的暴露
网络隔离|使用 DMZ 或在独立的托管基础设施，将面向外部的服务器和服务与网络的其他部分分离
账户权限|最小化特权
软件更新|确保应用保持最新
更新软件|定期扫描外部系统的漏洞，并建立程序以在通过扫描和公开披露发现重大漏洞时快速修补系统

#### 检测

- 监视应用程序日志中是否有异常行为
- DPI检测
- WAF

***

### External Remote Services (外部远程服务)

>[原文链接](https://attack.mitre.org/techniques/T1133/)

VPN，Citrix 和其他访问机制等远程服务使用户可以从外部位置连接到内部企业网络资源。经常有远程服务网关管理这些服务的连接和凭据身份验证。Windows Remote Management 等服务也可以在外部使用。

- 攻击者可以通过远程服务进行初始入侵和/或在网络中持久化
- 访问有效账户对于该服务是必须的，可以通过篡改和在入侵企业网络后获取

#### 缓解

缓解|描述
:--:|:--
禁用或删除功能或程序|禁用或阻止可能不必要的远程可用服务
限制通过网络对资源的访问|通过集中管理的集中器(例如VPN)和其他托管的远程访问系统，限制对远程服务的访问
多因素认证|对远程服务帐户使用强大的两因素或多因素身份验证
网络隔离|通过使用网络代理，网关和防火墙来拒绝对内部系统的直接远程访问

#### 检测

- 检测恶意使用有效账户对远程服务进行认证
- 收集身份验证日志并分析异常访问模式，以及正常工作时间之外的访问

***

### Hardware Additions (物理渗透硬件)

>[原文链接](https://attack.mitre.org/techniques/T1200/)

计算机附件、计算机或网络硬件可以作为获得执行的载体引入系统。 虽然 APT 组织使用的公共的很少，但是许多渗透测试人员利用物理渗透硬件来获得初始访问。 商业和开源产品利用了被动网络访问 、中间人破解 、击键注入 、通过DMA读取内核内存、向现有网络 添加新的无线访问等功能。

#### 缓解

缓解|描述
:--:|:--
限制通过网络对资源的访问|建立网络访问控制策略，如使用设备证书和 802.1x 标准。 将DHCP的使用限制在已注册的设备上，以防止未注册的设备与可信系统通信
限制硬件安装|通过终端安全配置和监视代理拦截未知设备和附件

#### 检测

资产管理系统可以帮助检测不应存在于网络中的计算机系统或网络设备。 终端传感器可以通过 USB、Thunderbolt 和其他外部设备通信端口检测添加的硬件。

***

### Replication Through Removable Media (通过可移动媒介复制)

>[原文链接](http://vulhub.org.cn/attack/techniques/T1091.md)

攻击者可以通过将恶意软件复制到可移动媒介上，利用媒体插入系统并执行的自动运行特性，转移到系统，这些系统处于未连通或存在空隙网络上。在 **横向移动** 中，可以修改可移动媒介中的可执行文件，或者复制恶意软件并将其重命名，使其看起来像合法文件，从而诱使用户在独立的系统上执行它。对于 **初始访问** ，可以通过手动操作媒体、修改用于初始格式化媒体的系统或修改媒体本身的固件来实现。

#### 缓解

缓解|描述
:--:|:--
禁用或删除功能或程序|如果不需要，可以禁用autorun;如果业务操作不需要可移动媒介，则在组织策略级别上禁止或限制它
限制硬件安装|限制在网络中使用USB设备和可移动媒介

#### 检测

- 监视可移动媒介上的文件访问
- 检测在可移动媒介被挂载或由用户启动后执行的进程

***

### Spearphishing Attachment (鱼叉式钓鱼附件)

>[原文链接](https://attack.mitre.org/techniques/T1192/)

鱼叉式钓鱼附件是鱼叉式网络钓鱼的一种特殊变体,鱼叉附件使用了 **附加到电子邮件的恶意软件**。所有形式的鱼叉式钓鱼都是以电子方式提供的针对特定个人，公司或行业的社会工程学。在此情况下，攻击者将文件附加到钓鱼邮件中，并且依赖用户执行。

#### 缓解

缓解|描述
:--:|:--
杀毒软件|防病毒软件可以自动隔离可疑文件
网络入侵防护|网络入侵防御系统以及旨在扫描和删除恶意电子邮件附件的系统可以用来阻止活动
限制基于Web的内容|默认情况下，阻止不应该通过电子邮件传输的未知或未使用的附件是最佳做法，以防止某些媒介
用户培训|可以培训用户识别社交工程技术和电子邮件伪装

#### 检测

网络入侵检测系统和电子邮件网关可用于检测带有恶意附件的鱼叉式网络钓鱼。 引爆设计(detonation chambers)也可用于识别恶意附件。解决方案可以是基于签名和行为的，但是攻击者可能以某种方式构造附件来避免这些机制。

杀毒软件在扫描存储在电子邮件服务器或用户计算机上的文件时，可能会检测到恶意文档和附件。 终端检测或网络检测可以在打开附件(例如 Microsoft Word 文档或 PDF 文件，可以连接到 internet 或生成 Powershell) 时潜在地检测恶意事件，这些事件与客户端执行和脚本的漏洞利用等技术有关。

***

### Spearphishing Link (鱼叉式钓鱼链接)

>[原文链接](https://attack.mitre.org/techniques/T1192/)

鱼叉式钓鱼链接是鱼叉式钓鱼的一种特殊变体，区别在于他是用 **链接下载电子邮件的恶意软件**

#### 缓解

缓解|描述
:--:|:--
限制基于Web的内容|确定某些可用于造假网站的网站对于业务运营是否必要，并在无法很好地监控活动或构成重大风险的情况下考虑阻止访问
用户培训|可以培训用户识别社交工程技术和电子邮件伪装

#### 检测

检查电子邮件中的 **URL** 有助于检测指向已知恶意站点的链接。 引爆设计 (detonation chambers) 可用于检测这些链接，并自动转到这些站点以确定它们是否具有潜在恶意，或在等待用户访问链接时捕获内容。 这种技术通常涉及终端上的用户交互，因此一旦用户执行，就可能检测到鱼叉式钓鱼链接。

***

### Spearphishing via Service (服务式鱼叉钓鱼)

>[原文链接](http://vulhub.org.cn/attack/techniques/T1194.md)

服务式鱼叉钓鱼是鱼叉式钓鱼的一种特殊变体，区别在于他采用的是 **第三方服务** 。

攻击者将创建虚假的社交媒体帐户，并向员工传达潜在的工作机会。这样做可以提出合理的理由来询问环境中运行的服务，策略和软件。然后，对手可以通过这些服务发送恶意链接或附件。

#### 缓解

缓解|描述
:--:|:--
杀毒软件|防病毒软件可以自动隔离可疑文件
限制基于Web的内容|确定第三方服务对于企业的运营是否必要，不必要可以考虑阻止访问
用户培训|实行安全培训

#### 检测

***

### Supply Chain Compromise (供应链入侵)

>[原文链接](https://attack.mitre.org/techniques/T1195/)

供应链折衷是为了最终数据或系统折衷目的而在最终消费者收到产品或产品交付机制之前对其进行的操纵。

供应链入侵可以发生在供应链的任何阶段，包括：

- 开发工具的操作
- 开发环境的操作
- 源代码库的操作
- 软件更新/分发机制
- 受损/感染的系统映像
- 用修改的版本替换合法软件
- 向合法分销商销售修改/仿冒产品

尽管供应链的攻击可能会影响硬件或软件的任意组件，但想要获得执行的攻击者往往关注在软件分发阶段或更新渠道中对合法软件进行的恶意添加。 可以以特定的受害者群体为目标， 或将恶意软件分发给广泛的消费者群体，但仅对特定受害者的附加策略。

#### 缓解

缓解|描述
:--:|:--
更新软件|应该实施补丁程序管理过程
漏洞扫描|漏洞源的持续监视以及使用自动和手动代码检查工具

#### 检测

通过哈希校验或其他完整性校验机制来检验分布式二进制文件。扫描下载的文件查找是否有恶意签名，并尝试在部署之前测试软件和更新，同时注意潜在的可疑活动。对硬件进行物理检查以查找潜在的篡改。

***

### Trusted Relationship (受信关系)

>[原文链接](https://attack.mitre.org/techniques/T1199/)

攻击者可能会破坏或利用能够接触到目标受害者的组织。通过可信的第三方关系利用现有的连接，这些连接可能不受保护或者受到的审查比获取网络访问权的标准机制少。组织通常授予第二或第三方外部提供商高级访问权限，以允许它们管理内部系统。这些关系的例子包括IT服务承包商、托管安全供应商、基础设施承包商(例如HVAC、电梯、物理安全)。 第三方提供商的访问权可能被限制在所维护的基础结构内，但是可能与企业的其他部分在相同的网络中。这样，另一方用于访问内部网络系统的有效帐户可能会遭到破坏和使用

#### 缓解

缓解|描述
:--:|:--
网络隔离|网络分割隔离无需广泛网络访问的基础设施组件
用户帐号控制|妥善管理可受信关系中各方使用的帐户和权限

#### 检测

建立对由第二方和第三方提供商以及其他受信任实体进行的活动的监视。根据关系的类型，攻击可能在执行操作之前可以访问有关目标的大量信息，尤其是在信任的关系基于IT服务的情况下。对手可能能够快速地朝着目标行事，因此对与凭据访问，横向移动和收集有关的行为进行适当的监视对于检测入侵至关重要。

***

### Valid Accounts (合法账号)

>[原文链接](https://attack.mitre.org/techniques/T1078/)

攻击者可以使用凭据访问技术窃取特定用户或服务帐户的凭据，或者在侦察过程的早期通过社会工程来获取凭据以获得初始访问权限。

对手可能使用的帐户可以分为三类：默认帐户，本地帐户和域帐户。

被盗取的凭证可用于绕过网络内系统上的各种资源的访问控制，甚至可能用于对远程系统和外部可用服务的持久化。被盗取的凭证可能还会给攻击者提供特定系统或网络受限区域的特权。攻击者可能选择不将恶意软件或工具与这些凭据提供的合法访问结合使用，使其更难被察觉。

默认帐户也不仅限于客户端计算机上的访客和管理员，还包括为设备(例如网络设备和计算机应用程序)而预先设置的帐户，无论它们是内部，开放源代码还是COTS。预先设置了用户名和密码的设备会对在安装后不进行更改的使用者构成严重威胁，它们很容易成为攻击者的目标。同样，攻击者也可以利用公开披露的私钥或被盗的私钥通过远程服务 合法地连接到远程环境。

帐户访问权，凭据和权限在整个系统网络中的重叠是令人关注的，因为攻击者可能能够跨帐户和系统打到高访问级别(即域或企业管理员)，从而绕过企业内部访问控制。

#### 缓解

缓解|描述
:--:|:--
应用程序开发人员指南|确保应用程序不会不安全地存储敏感数据或凭据。(例如，代码中的纯文本凭据，存储库中已发布的凭据或公共云存储中的凭据)
用户帐号控制|妥善管理可受信关系中各方使用的帐户和权限
过滤网络流量|考虑在基于云的系统上将IP白名单与用户帐户管理一起使用
多因素认证|将多因素身份验证 (MFA) 集成为组织策略的一部分可以极大地降低g攻击者获得对有效凭据的控制的风险
密码策略|在安装后和部署到生产环境之前，应立即更改使用默认用户名和密码的应用程序和设备
特权账户管理|例行审核域和本地帐户及其权限级别，还应包括是否启用了默认帐户，或者是否创建了未经授权的新本地帐户
用户帐号管理|通过身份和访问管理 (IAM) 控件，确保用户和用户组对其角色具有适当的权限

#### 检测

- 在整个企业和外部可访问的服务配置健壮，一致的帐户活动审核策略
- 在共享帐户(用户，管理员或服务帐户)的系统中查找可疑帐户行为
- 对域和本地系统帐户进行​​定期审核

***

## Execution (执行)

>[攻击者试图运行恶意代码](https://attack.mitre.org/tactics/TA0002/)

**执行** 是指攻击者控制的代码在本地或者远程系统上运行，通常恶意代码通常与所有其他策略结合使用，以达成更大的目标。

***

### AppleScript (AppleScript)

>[原文链接](https://attack.mitre.org/techniques/T1155/)

**macOS** 和 **OS** **X** 的应用互相发送 **AppleEvent** 消息以实现进程间通信(IPC)。AppleScript 可以轻松编写本地或远程IPC的通信消息。Osascript 执行 AppleScript 和任何其他开放脚本编写体系结构 (OSA) 语言脚本。可以使用 osalang 程序找到安装在系统上的 OSA 语言列表

攻击者可以使用它与打开的SSH连接进行交互，移至远程计算机，甚至向用户显示虚假对话框。这些事件无法远程启动应用程序(尽管它们可以在本地启动它们)，但是如果它们已经在远程运行，则可以与应用程序进行交互。由于这是一种脚本语言，因此它也可以用于启动更通用的技术，例如通过 python 反弹 shell 。脚本可以通过 <kbd>osascript /path/to/script</kbd> 或从命令行运行 <kbd>osascript -e "script here"</kbd>。

#### 缓解

缓解|描述
:--:|:--
代码签名|要求所有 AppleScript 在执行之前都要由受信任的开发人员 ID 签名，这将阻止随机的 AppleScript 代码执行

#### 检测

通过 osascript 监视 AppleScript 的执行，该脚本可能与系统上发生的其他可疑行为有关。

***

### CMSPT (CMSTP.exe)

>[原文链接](https://attack.mitre.org/techniques/T1191/)  
>[相关链接](https://www.freebuf.com/articles/system/172515.html)

Microsoft 连接管理器配置文件安装程序 (CMSTP.exe) 是用于安装连接管理器服务配置文件的命令行程序。CMSTP.exe 接受安装信息文件 (INF) 作为参数，并安装用于远程访问连接的服务配置文件。

攻击者可能向 **CMSTP.exe** 提供了感染了恶意命令的INF文件。与 **Regsvr32** / **Squiblydoo** 类似，攻击者可能滥用 **CMSTP.exe** 从远程服务器加载和执行 **DLL** 和/或 **COM脚本**。由于 **CMSTP.exe** 是合法的、Microsoft 签名的应用程序，因此该执行过程也可以绕过 AppLocker 和其他白名单防御。

**CMSTP.exe** 还可能被滥用于绕过用户帐户控制，并通过自动提升的COM接口执行来自恶意 **INF** 的任意命令。

#### 缓解

缓解|描述
:--:|:--
禁用或删除功能或程序|在给定的环境中，CMSTP.exe 可能不是必需的(除非用于 VPN 连接安装)
预防执行|如果给定系统或网络不需要 CMSTP.exe，可以考虑使用配置为阻止CMSTP.exe 执行的应用程序白名单来防止对手潜在的滥用

#### 检测

使用进程监视来检测和分析 CMSTP.exe 的执行和参数。 将 CMSTP.exe 最近调用与之前的已知良好参数和被加载的文件进行比较，以确定异常和潜在的攻击活动。

还可以使用 Sysmon 事件识别 CMSTP.exe 的潜在滥用。 检测策略可能取决于特定的攻击者程序，但可能的规则包括：

- 检测本地/远程 payload 的加载和执行——Event 1(进程创建)，其中 ParentImage 包含 CMSTP.exe 和/或 Event 3(网络连接)，其中 Image 包含 CMSTP.exe, DestinationIP 是外部的
- 检测通过自动提升 (auto-elevated) 的 COM 接口绕过用户帐户控制-事件 10 (ProcessAccess)，其中 CallTrace 包含 CMLUA.dll 和/或 Event 12 或 13 (RegistryEvent)，其中 TargetObject 包含 CMMGR32.exe。 还可以监视事件，例如进程创建 (Sysmon Event 1)，例如涉及自动提升 CMSTP COM 接口，如 CMSTPLUA(3E5FC7F9-9A51-4367-9063-A120244FBEC7)和 CMLUAUTIL(3E000D72-A845-4CD9-BD83- 80C07C3B881F)

***

### Command-Line Interface (命令行界面)

>[原文链接](https://attack.mitre.org/techniques/T1059/)

命令行界面提供了一种与计算机系统交互的方式，许多操作系统平台都有该功能。其在 Windows 系统上的一个例子就是 **cmd**，它可以用来执行许多任务，包括执行其他软件。命令行界面可以在本地交互，也可以通过远程桌面应用程序、反弹 shell 等进行远程交互。执行的命令以命令行界面进程的当前权限级别运行，除非该命令包含更改该执行的权限上下文的进程调用(例如，计划任务)。

攻击者可以使用命令行界面与系统交互，并在操作过程中执行其他软件。

#### 缓解

缓解|描述
:--:|:--
预防执行|通过使用应用程序白名单工具来审核和/或阻止不必要的命令行

#### 检测

可以通过用命令行参数适当记录进程执行来捕获命令行界面活动。这些信息可以帮助他们通过攻击者使用本机进程或自定义工具的方式更多地了解攻击者行为。

***

### Compiled HTML File (.chm文件)

>[原文链接](https://attack.mitre.org/techniques/T1223/)

已编译的HTML文件 (.chm文件) 通常作为 Microsoft HTML 帮助系统的一部分分发。.chm 文件是各种内容(如 HTML 文档、图像)和编程语言相关的脚本/web(如 VBA、JScript、Java 和 ActiveX) 的压缩编译。 CHM 内容使用由 HTML 帮助可执行程序 (hh.exe) 加载的 Internet Explorer 浏览器 的底层组件显示。

#### 缓解

#### 检测

***

## Persistence (持久化)

***

## Privilege Escalation (提权)

***